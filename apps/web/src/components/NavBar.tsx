import { Link } from '@tanstack/react-router';
import "./NavBar.css";
import { useUserDataStore } from '@/utils/userStore';
import type { UserToken } from '@/types';

function NavBar() {
    // console.debug("NavBar");
    const user = useUserDataStore((state) => state.userData) as UserToken;

    return (
        <div id="NavBar drawer">
            {/* TODO: nav bar currently does not close after clicking on a link.
                It is also stuck behind the medication cards. Change the z-index. */}
            <input id="my-drawer-3" type="checkbox" className="drawer-toggle" />
            <div className="drawer-content flex flex-col mx-8 lg:mx-16">
                {/* Navbar */}
                <div className="w-full navbar">
                    <div id="NavBar-logo" className="flex-1">
                        <Link to="/">
                            <svg width="162" height="165" viewBox="0 0 162 165" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M2.36328 130V103.281H5.23438C7.52604 103.281 9.27083 103.958 10.4688 105.312C11.6797 106.654 12.2852 108.444 12.2852 110.684C12.2852 113.223 11.3607 115.13 9.51172 116.406C10.944 117.422 12.1615 120.124 13.1641 124.512L14.3945 130H10.8008L9.76562 125.391C9.02344 122.161 8.37891 120.111 7.83203 119.238C7.28516 118.353 6.60807 117.956 5.80078 118.047V130H2.36328ZM5.80078 114.844H5.95703C7.88411 114.844 8.84766 113.496 8.84766 110.801C8.84766 107.936 7.83203 106.497 5.80078 106.484V114.844ZM22.9336 130V103.281H32.4453V106.484H26.3711V114.473H31.9375V117.676H26.3711V126.797H32.7773V130H22.9336ZM42.4688 129.316V125.762C43.4974 126.751 44.4935 127.246 45.457 127.246C46.1732 127.246 46.7852 126.992 47.293 126.484C47.8008 125.977 48.0547 125.365 48.0547 124.648C48.0547 124.036 47.9115 123.294 47.625 122.422C47.3385 121.549 46.5638 119.941 45.3008 117.598C44.0508 115.241 43.237 113.457 42.8594 112.246C42.4818 111.035 42.293 109.967 42.293 109.043C42.293 107.246 42.8008 105.781 43.8164 104.648C44.8451 103.503 46.1536 102.93 47.7422 102.93C48.6406 102.93 49.5977 103.164 50.6133 103.633V106.875C49.6758 106.315 48.875 106.035 48.2109 106.035C46.4792 106.035 45.6133 106.888 45.6133 108.594C45.6133 109.219 45.7565 109.974 46.043 110.859C46.3424 111.732 47.1172 113.333 48.3672 115.664C49.6302 117.982 50.444 119.753 50.8086 120.977C51.1862 122.188 51.375 123.262 51.375 124.199C51.375 126.022 50.8607 127.507 49.832 128.652C48.8164 129.785 47.4948 130.352 45.8672 130.352C44.6953 130.352 43.5625 130.007 42.4688 129.316ZM66.9844 130.352C64.875 130.352 63.1562 129.134 61.8281 126.699C60.5 124.251 59.8359 120.898 59.8359 116.641C59.8359 112.617 60.4609 109.329 61.7109 106.777C62.974 104.212 64.7318 102.93 66.9844 102.93C69.1719 102.93 70.9102 104.206 72.1992 106.758C73.5013 109.31 74.1523 112.604 74.1523 116.641C74.1523 120.938 73.4688 124.297 72.1016 126.719C70.7344 129.141 69.0286 130.352 66.9844 130.352ZM66.9453 106.113C65.8125 106.113 64.9401 107.051 64.3281 108.926C63.7292 110.788 63.4297 113.359 63.4297 116.641C63.4297 120.039 63.7422 122.643 64.3672 124.453C64.9922 126.263 65.8776 127.168 67.0234 127.168C68.1172 127.168 68.9766 126.243 69.6016 124.395C70.2396 122.546 70.5586 119.961 70.5586 116.641C70.5586 113.268 70.2396 110.671 69.6016 108.848C68.9635 107.025 68.0781 106.113 66.9453 106.113ZM83.668 103.281H87.1055V123.359C87.1055 125.898 87.9453 127.168 89.625 127.168C90.3672 127.168 90.9727 126.849 91.4414 126.211C91.9102 125.573 92.1445 124.674 92.1445 123.516V103.281H95.582V123.125C95.582 125.469 94.9896 127.259 93.8047 128.496C92.6198 129.733 91.2266 130.352 89.625 130.352C87.9193 130.352 86.5 129.707 85.3672 128.418C84.2344 127.129 83.668 125.456 83.668 123.398V103.281ZM106.113 130V103.281H108.984C111.276 103.281 113.021 103.958 114.219 105.312C115.43 106.654 116.035 108.444 116.035 110.684C116.035 113.223 115.111 115.13 113.262 116.406C114.694 117.422 115.911 120.124 116.914 124.512L118.145 130H114.551L113.516 125.391C112.773 122.161 112.129 120.111 111.582 119.238C111.035 118.353 110.358 117.956 109.551 118.047V130H106.113ZM109.551 114.844H109.707C111.634 114.844 112.598 113.496 112.598 110.801C112.598 107.936 111.582 106.497 109.551 106.484V114.844ZM136.918 125.234V128.848C135.629 129.85 134.268 130.352 132.836 130.352C130.544 130.352 128.773 129.18 127.523 126.836C126.273 124.492 125.648 121.146 125.648 116.797C125.648 112.448 126.273 109.049 127.523 106.602C128.786 104.154 130.583 102.93 132.914 102.93C134.034 102.93 135.264 103.392 136.605 104.316V107.793C135.46 106.673 134.314 106.113 133.168 106.113C131.788 106.113 130.785 106.927 130.16 108.555C129.548 110.169 129.242 112.865 129.242 116.641C129.242 120.378 129.555 123.066 130.18 124.707C130.805 126.348 131.84 127.168 133.285 127.168C134.275 127.168 135.486 126.523 136.918 125.234ZM146.004 130V103.281H155.516V106.484H149.441V114.473H155.008V117.676H149.441V126.797H155.848V130H146.004Z" fill="black" />
                                <path d="M41 17H44.44C49.6133 17 54.1467 18.92 58.04 22.76C61.9867 26.5467 63.96 31.0267 63.96 36.2C63.96 41.32 61.96 45.7733 57.96 49.56C53.96 53.3467 49.6667 55.24 45.08 55.24H44.52L65.16 77H61.72L43.56 57.96V77H41V17ZM43.56 52.92H45C49.32 52.92 53.1333 51.2667 56.44 47.96C59.7467 44.6533 61.4 40.7333 61.4 36.2C61.4 31.6667 59.6933 27.72 56.28 24.36C52.8667 21 48.9733 19.32 44.6 19.32H43.56V52.92ZM98.1381 55.16L112.618 77H109.658L96.6981 57.4L83.8181 77H81.2581L95.4181 55.4L85.8981 41H88.8581L96.8581 53.16L104.858 41H107.418L98.1381 55.16Z" fill="black" />
                            </svg>
                        </Link>
                    </div>
                    <div className="flex-none hidden lg:block">
                        <nav id="NavBar-menu">
                            {!user &&
                                <>
                                    <Link to="/signup" className="[&.active]:font-bold">
                                        Signup
                                    </Link>
                                    <Link to="/login" className="[&.active]:font-bold">
                                        Login
                                    </Link>

                                </>}

                            {user &&
                                <>
                                    {/* TODO: Logout is not currently implemented. Cleare localStorage if you want to leave :`(
                                     //     <Link to="/login" onClick={logout}>Logout</Link> */}

                                    <Link to="/" className="[&.active]:font-bold">
                                        Search Medications
                                    </Link>
                                    <Link to="/cabinet" className="[&.active]:font-bold">
                                        My Medicine Cabinet
                                    </Link>
                                </>
                            }
                        </nav>
                    </div>
                    <div className="flex-none lg:hidden">
                        <label className="btn btn-circle btn-secondary swap swap-rotate z-10" aria-label="open sidebar" htmlFor="my-drawer-3">

                            {/* this hidden checkbox controls the state */}
                            <input type="checkbox" />

                            {/* hamburger icon */}
                            <svg className="swap-off fill-primary [:checked~*_&]:!-rotate-45 [:checked~*_&]:!opacity-0" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /></svg>

                            {/* close icon */}
                            <svg className="swap-on fill-primary [:checked~*_&]:!rotate-0 [:checked~*_&]:!opacity-100" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49" /></svg>

                        </label>
                    </div>
                </div>
            </div>
            <div id="NavBar-mobile-menu" className="drawer-side">
                <label htmlFor="my-drawer-3" aria-label="close sidebar" className="drawer-overlay"></label>
                <ul className="menu pt-28 px-4 w-full min-h-full bg-neutral text-base-100 text-2xl">
                    {/* Sidebar content here */}
                    {!user &&
                        <>
                            <li><Link to="/signup">Signup</Link></li>
                            <li><Link to="/login">Login</Link></li>
                        </>}

                    {user &&
                        <>
                            <li><Link to="/" >Medications</Link></li>
                            <li><Link to="/cabinet">My Medicine Cabinet</Link></li>
                            {/* TODO: Logout is not currently implemented. Cleare localStorage if you want to leave :`(
                                <li><Link to="/" onClick={logout}>Logout</Link></li> */}
                        </>
                    }
                </ul>
            </div>
        </div>
    );
}

export default NavBar;